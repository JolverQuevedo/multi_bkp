--PANTALLA DE INICIO
-- SELECCIONAR EL ALMACEN 
 Select A1_CALMA, A1_CDESCRI From RSFACCAR..AL0001ALMA Order by A1_CALMA
 
 Select A1_CLOCALI,A1_CALMA,A1_CDESCRI,A1_CCTLNUM From RSFACCAR..AL0001ALMA Where A1_CALMA='00T2' 
 Update RSFACCAR..ALCIAS Set AC_CALMA='00JC'  WHERE AC_CCIA='0001'
 

-- MAESTRO DE USUARIOS
Select TU_ALIAS As CadeBus,* From RSFACCAR..UT0030 Order by TU_ALIAS
-- FLAG DE SI REQUIERE CENTRO DE COSTO DE LA TABLA DE ALMACENES
Select A1_CCOSTO From RSFACCAR..AL0001ALMA Where A1_CALMA='00T2'
-- TABLAS GENERALES
Select TG_CDESCRI From RSFACCAR..AL0001TABL Where TG_CCOD='93' AND TG_CCLAVE= 'SERUNI      '
--********************************************************************************************************
-- ACA EMPIEZA
-- TABLA DE ALMACENES
Select * From RSFACCAR..AL0001ALMA Order by A1_CALMA
-- MONEDA
Select * From RSFACCAR..AL0001TABL Where TG_CCOD='03' Order by TG_CCLAVE
-- cuentas contables
Select * From RSCONCAR..CT0001TAGE Where TCOD='07' Order by TCLAVE
------------- ********************************************************* ---------------------------------
Select * From RSFACCAR..AL0001TABL Where TG_CCOD='00' Order by TG_CCLAVE
------------- ********************************************************* ---------------------------------<
-- tipos de conversion
Select * From RSFACCAR..AL0001TABL Where TG_CCOD='37' Order by TG_CCLAVE
-- tipos de facturas
Select TG_CDESCRI From RSFACCAR..AL0001TABL Where TG_CCOD='94' AND TG_CCLAVE='PE          '
-- tipo de movimiento
Select * From RSFACCAR..AL0001TABM Where TM_CTIPMOV='E' And TM_CCODMOV='EP'
-- descripcion del tipo de movimiento
Select TM_CDESCRI From RSFACCAR..AL0001TABM Where TM_CTIPMOV='E' AND TM_CCODMOV='EP'
-- tgipo de cambio de la fecha de ingreso
Select XCODMON,XMEIMP,XMEIMP2 From RSCONCAR..CTCAMB Where XCODMON='US' And CONVERT(DATETIME,XFECCAM2,103)=Convert(datetime,'13/01/2014',103) 
-- abreviatura de la moneda
Select TG_CCLAVE From RSFACCAR..AL0001TABL Where TG_CCOD='03' AND TG_CCLAVE='US          '
-- tipo de cambio venta
Select TG_CCLAVE From RSFACCAR..AL0001TABL Where TG_CCOD='37' AND TG_CCLAVE='V           '
-- tipo de cambio de la fecha 
Select XCODMON,XMEIMP,XMEIMP2 From RSCONCAR..CTCAMB Where XCODMON='US' And CONVERT(DATETIME,XFECCAM2,103)=Convert(datetime,'13/01/2014',103) 
-- proveedores
Select AC_CCODIGO From RSCONCAR..CP0001MAES Where AC_CVANEXO='P' AND AC_CCODIGO='20100174911       '
Select AC_CNOMBRE From RSCONCAR..CP0001MAES Where AC_CVANEXO='P' AND AC_CCODIGO='20100174911       '
-- tipos de documetos de referencia
Select TG_CCLAVE, TG_CDESCRI From RSFACCAR..AL0001TABL Where TG_CCOD='04' 

-- empresas
Select AC_CCIA,AC_CNOMCIA From RSFACCAR..ALCIAS Order by AC_CCIA 

-- solicitante autorizado
Select TG_CCLAVE, TG_CDESCRI From RSFACCAR..AL0001TABL Where TG_CCOD='12'
Select TG_CCLAVE From RSFACCAR..AL0001TABL Where TG_CCOD='12' AND TG_CCLAVE='ch          '
Select TG_CDESCRI From RSFACCAR..AL0001TABL Where TG_CCOD='12' AND TG_CCLAVE='ch          '
-- centro de costo
Select TG_CCLAVE, TG_CDESCRI From RSFACCAR..AL0001TABL Where TG_CCOD='10' 
Select TG_CCLAVE From RSFACCAR..AL0001TABL Where TG_CCOD='10' AND TG_CCLAVE='20000'
Select TG_CDESCRI From RSFACCAR..AL0001TABL Where TG_CCOD='10' AND TG_CCLAVE='20000   '

-- Tipo de movimiento
Select * From RSFACCAR..AL0001TABM Where TM_CTIPMOV='E' And TM_CCODMOV='EP'
-- moneda
Select TG_CCLAVE From RSFACCAR..AL0001TABL Where TG_CCOD='03' AND TG_CCLAVE='US          '

--ruc del proveedor
Select AC_CCODIGO From RSCONCAR..CP0001MAES Where AC_CVANEXO='P' AND AC_CCODIGO='20100174911       '
-- tipo de docuemnto de referencia
Select TG_CCLAVE From RSFACCAR..AL0001TABL Where TG_CCOD='04' AND TG_CCLAVE='PO          '
-- solicitante autorizado
Select TG_CCLAVE From RSFACCAR..AL0001TABL Where TG_CCOD='12' AND TG_CCLAVE='ch          '
-- centro de costo
Select TG_CCLAVE From RSFACCAR..AL0001TABL Where TG_CCOD='10' AND TG_CCLAVE='20000'

-- almacen de referencia
 Select A1_CALMA, A1_CDESCRI From RSFACCAR..AL0001ALMA Order by A1_CALMA
-- cliente
Select * From RSFACCAR..FT0001CLIE where cl_cestado = 'v' and cl_ccodcli like'%e%' and cl_czonvta = '0003'
Order by CL_CCODCLI



--tipo de anexo
Select * From RSCONCAR..CT0001TAGE Where TCOD='07' Order by TCLAVE







--Select * From RSFACCAR..AL0001TABL Where TG_CCOD='00' order by 2
-- articulo
SELECT AR_CDESCRI,AR_CUNIDAD,AR_CLINEA,AR_CFDECI,AR_CFLOTE,AR_CFSERIE,AR_CFCELU, AR_NIGVPOR,AR_CMONCOM,AR_NPRECOM,AR_NPRECI2 From RSFACCAR..AL0001ARTI Where AR_CCODIGO='1628600000'








-- movimientos para el nuevo parte de entrada
Select * From RSFACCAR..AL0001MOVC Where C5_CALMA='00T2' AND C5_CTD='pe' --And C5_CNUMDOC='00014900002'
-- ULTIMO NUMERO DE PARTE DE ENTRADA POR ALMACEN
Select A1_NNUMENT From RSFACCAR..AL0001ALMA Where A1_CALMA='00T2' 

Select distinct c5_ctd, c5_ctipmov, c5_ccodmov From RSFACCAR..AL0001MOVC Where C5_CALMA='00T2' AND C5_CTD='pe'


-- ACTUALIZA EL NUNMERADOR DE PARTES DE ENTRADA
--Update RSFACCAR..AL0001ALMA Set A1_NNUMENT=14900004 Where A1_CALMA='00T2' 

select right(('00000' + LTRIM(RTRIM(casT(A1_NNUMENT as char(11))))),11) from  RSFACCAR..AL0001ALMA Where A1_CALMA='00T2' 
select CAST(A1_NNUMENT AS VARCHAR(LEN(A1_NNUMENT))) from  RSFACCAR..AL0001ALMA Where A1_CALMA='00T2' 

-- 00014900002
 Where c5_CALMA='00T2'  and c5_ctd = 'pe'
order by c5_cnumdoc desc


-- INSERTA CABECERA DE MOVIMIENTOS
select * from RSFACCAR..AL0001MOVC where c5_ctd = 'pe'

--Insert Into 
select distinct C5_CNUMORD, C5_CCIAS, *  from  RSFACCAR..AL0001MOVC where c5_ctd = 'pe'
(C5_CALMA,C5_CTD,C5_CTIPMOV,C5_CCODMOV,C5_CNUMDOC,C5_DFECDOC,C5_CCODPRO,
C5_CRFTDOC,C5_CRFTDO2,C5_CRFNDOC,C5_CRFNDO2,C5_CNUMORD,C5_CCIAS,C5_CORDEN,C5_CSOLI,C5_CCENCOS,C5_CRFALMA,
C5_CCODCLI,C5_CCODANE,C5_CGLOSA1,C5_CGLOSA2,C5_CGLOSA3,C5_CNOMPRO,C5_CNOMCLI,C5_DFECCRE,C5_CUSUCRE,
C5_CLOCALI,C5_CSITUA,C5_CCODMON,C5_CTIPO,C5_NTIPCAM) 
Values('00T2','PE','E','EP','00014900002',Convert(datetime,'13/01/2014 00:00:00',103),
'20100174911','PO','','214-844','',
'','','540291','ch','20000','','','','produccion exportacion','',
'','EL MODELADOR S.A.                                 ','                                                  ',
Convert(datetime,'14/01/2014 13:01:42',103),'sist ','0001','V','US','V',2.799)
-- INSERTA DETALLE DE MOVIMIENTOS
Insert Into RSFACCAR..AL0001MOVD(C6_CALMA,C6_CTD,C6_CNUMDOC,C6_CCODMOV,C6_CITEM,C6_CCODIGO,C6_CDESCRI,
C6_CORDEN,C6_NCANTID,C6_DFECDOC,C6_CLOCALI,C6_CCENCOS,C6_CSOLI,C6_CCODMON,C6_CTIPO,C6_NTIPCAM,
C6_NPREUN1,C6_NPREUNI,C6_NVALTOT,C6_NPORDE1,C6_NPORDE2,C6_NPORDE3,C6_NPORDE4,C6_CESTADO,C6_NUSIMPO,
C6_NUSPRUN,C6_NMNIMPO,C6_NMNPRUN) Values('00T2','PE','00014900002','EP','0001',
'1628600000               ','POLO BUTTON SHORT SLEEVES                         ',
'540291            ',2,Convert(datetime,'13/01/2014 00:00:00',103),'0001','20000 ','ch',
'US','V',2.799,1,1,2,0,0,0,0,'V',2,1,5.598,2.799)

Select A1_CALMA From RSFACCAR..AL0001ALMA Where A1_CALMA='00T2'
Select AR_CCODIGO,AR_CFSERIE,AR_CFLOTE,AR_CESTADO,AR_CTIPO,AR_CFSTOCK 
From RSFACCAR..AL0001ARTI Where AR_CCODIGO='1628600000'
Select SK_CALMA,SK_CCODIGO,SK_NSKDIS From RSFACCAR..AL0001STOC 
Where SK_CALMA='00T2' AND SK_CCODIGO='1628600000'
-- ACTUALIZA EL STOCK
--Update RSFACCAR..AL0001STOC Set SK_NSKDIS=9,SK_DFECMOV=Convert(datetime,'13/01/2014',103) 
Where  SK_CALMA='00T2' AND SK_CCODIGO='1628600000'
-- IMPRESION DEL PARTE
Select TG_CDESCRI From RSFACCAR..AL0001TABL Where TG_CCOD='93' AND TG_CCLAVE= 'SERUNI      '
Select * From RSFACCAR..AL0001MOVC Where C5_CALMA='00T2' AND C5_CTD='PE' AND C5_CNUMDOC='00014900002'
Select A1_CDESCRI From RSFACCAR..AL0001ALMA Where A1_CALMA='00T2'
Select A1_CDESCRI From RSFACCAR..AL0001ALMA Where A1_CALMA='    '
Select AC_CRUC From RSCONCAR..CP0001MAES Where AC_CVANEXO='P' AND AC_CCODIGO='20100174911       '
Select TM_CDESCRI From RSFACCAR..AL0001TABM Where TM_CTIPMOV='E' AND TM_CCODMOV='EP'
Select * From RSFACCAR..AL0001MOVD Where C6_CALMA='00T2' AND C6_CTD='PE' AND C6_CNUMDOC='00014900002' ORDER BY C6_CITEM
Select AR_CUNIDAD From RSFACCAR..AL0001ARTI Where AR_CCODIGO='1628600000               '
Select AR_CFSERIE From RSFACCAR..AL0001ARTI Where AR_CCODIGO='1628600000               '